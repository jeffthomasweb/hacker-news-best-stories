import httpx
import asyncio

#Function to get the titles of Hacker News best stories. Parameter number_stories is used to tell the
#function how many stories to return. This function uses Python's asyncio library and the async
#requests library httpx. 

async def hnews(number_stories):
    #The Hacker News API has an endpoint that lists the item numbers for the stories currently ranked
    #best. Use async requests library httpx to get the item numbers. 
    
    #The documentation for the httpx library formats async requests in a format like below. 
    async with httpx.AsyncClient() as client:
        a = await client.get("https://hacker-news.firebaseio.com/v0/beststories.json?print=pretty")       
        #Get the response as json.
        a_json = a.json()
        
        #Functin parameter number_stories below.
        b = a_json[0:number_stories] 
        
        #Empty list to add story titles.
        list = []
        for c in b:
            list.append(f"https://hacker-news.firebaseio.com/v0/item/{c}.json?print=pretty")
    
        #Creat empty list list_title to add the parsed story titles 
        list_title = []

        #await for async requests.
        for e in list:
            list_title.append(await client.get(e))

        #Get parse the titles in the json response.
        list_title_json = []
        for f in list_title:
            list_title_json.append(f.json()["title"])
        
        #Print the titles in the terminal.
        for item in list_title_json:
            print(item + '\n' + '\n')

#Run the function with a function parameter of 20 stories.
asyncio.run(hnews(20))
